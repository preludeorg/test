# Will your computer quarantine a malicious Office document?

This test uses a popular payload-generating software known as Msfvenom to record a macro into an .xlsm file, which is then dropped to disk. 
Msfvenom is widely used by threat actors to quickly embed malicious code into otherwise benign files. The embedded code could be anything: 
a reverse shell, a ransomware attack or in this case, just a simple "whoami" command to print the current user's name. 
Because this software is so popular, it carries a signature that can be flagged whenever a file generated by it is saved to the hard drive. 
For the macro to work, a user would need to open the file and ensure macros are enabled - which is a separate set of controls that offer protection - 
but an endpoint should never let it get that far.

Example output:
```
[+] Extracting file for quarantine test
[+] Pausing for 1 second to gauge defensive reaction
[-] Malicious file was not caught
```

Defenses should quarantine files with known signatures immediately.

## How

> Safety: the macro has been defanged, so even if run, it will only print your username

An .xlsm file containing the macro is extracted from the test and written to a user-owned directory. The test then waits briefly before running a few checks to determine if it was responded to (not just detected) by any defensive products on the endpoint. 
